\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}
\usepackage{a4wide}
\usepackage{amsmath}
\usepackage{graphicx}

\usepackage[pdfborder=0 0 0]{hyperref}



\title{Základy Počítačové grafiky}
\author{Tomáš Maršálek}
\date{27.\,října 2012}



\begin{document}
\maketitle
\section{Úvod}
Pro semestrální práci jsem po osobní dohodě se cvičícím zvolil jazyk Java, poté
podle vlastního výběru jeden z nejpoužívanějších wrapperů OpenGL pro Javu -
\textbf {Lightweight Java Game Library (LWJGL)}.


\section{Výpočty}
\subsection{Terén}
Terén je načten ze souboru a v programu používán jako objekt třídy
\textbf{Terrain}. Terén je $H - 1$ trojúhelníkových pruhů
(\textit{GL\_TRIANGLE\_STRIPS}) délky $W$. Objekt \textbf{Terrain} ulehčuje
práci pomocí metod umožňujících získání výšky nebo normály v daném bodě
této trojúhelníkové sítě.

\subsection{Výpočet normál terénu}
Normála v každém bodě trojúhelníkové sítě je vypočtena jako průměr normál čtyř
okolních myšlených trojúhelníků, popřípadě tří normál na hraně terénu nebo dvou
v rozích. \\

\begin{align*}
\mathbf {n1} &= \left[ \mathbf {terrain}(x + 1, z) - \mathbf {terrain}(x, z)
\right] \times \left[ \mathbf {terrain}(x, z + 1) - \mathbf {terrain}(x, z)
\right] \\
%
\mathbf {n2} &= \left[ \mathbf {terrain}(x, z + 1) - \mathbf {terrain}(x, z)
\right] \times \left[ \mathbf {terrain}(x - 1, z) - \mathbf {terrain}(x, z)
\right] \\
%
\mathbf {n3} &= \left[ \mathbf {terrain}(x - 1, z) - \mathbf {terrain}(x, z)
\right] \times \left[ \mathbf {terrain}(x, z - 1) - \mathbf {terrain}(x, z)
\right] \\
%
\mathbf {n4} &= \left[ \mathbf {terrain}(x, z - 1) - \mathbf {terrain}(x, z)
\right] \times \left[ \mathbf {terrain}(x + 1, z) - \mathbf {terrain}(x, z)
\right] \\
\end{align*}

\begin{align*}
\mathbf n &:= \mathbf {n1} + \mathbf {n2} + \mathbf {n3} + \mathbf {n4} \\
\mathbf n &:= \frac{\mathbf n}{\|\mathbf n\|} \\
\end{align*}

\begin{center}
\includegraphics[width=10cm]{normals_persp.pdf}
\end{center}

\subsection{Detekce kolizí při pohybu po terénu}
Nejprve je spočten směrový vektor v rovině XZ podle momentálně stisknutých
kláves WSAD. Výšková složka tohoto vektoru je dopočtena jako rozdíl výšky v
terénu nad současnou pozicí a výškou nad novou pozicí určenou směrovým vektorem
v rovině. Vektor je pak normalizován a zvětšen rychlostním koeficientem, který
zaručuje, že rychlost bude konstantně 3m/s nehledě na snímkové frekvenci.

Tento rychlostní vektor je pak přičten k současné pozici.

Problém však nastává s výškou pozorovatele nad terénem, která je pevně dána na
1.85m. Použitím relativního vektoru rychlosti dochází ke kumulaci
zaokrouhlovacích chyb a po chvíli chození po terénu je výška očí zcela jiná,
než 1.85m. Proto je v každém snímku provedena korekce, která zaručuje, že oči
budou neustále stejně vysoko.

\subsection{Plynulá intenzita světla}
Máme-li den, který trvá od času 0 (00:00) do 1 (24:00), očekáváme v čase 0.5
nejvyšší intenzitu světla. Použitá funkce určující intenzitu slunce je Gaussova
křivka centrovaná do bodu 0.5.
$$
Intenzita~=~e^{- (C(t - \frac{1}{2}))^2}
$$
kde C je magická konstanta, která byla nalezena po chvíli testování tak, aby
byl výsledek co nejbližší skutečnosti.

Získaná intenzita se používá přímo jako intenzita hlavního zdroje světla - slunce a jako barva atmosféry.

\section{Přeložení a spuštění}
Aplikace byla vyvíjena pod GNU/Linux, přiložené knihovny a instrukce pro spuštění aplikace jsou pro Windows.

\subsection{Adresářová struktura}
\subsection{Z příkazové řádky}
přeložení:
\begin{verbatim}
$  javac -cp .;lib\jars\lwjgl.jar:lib\jars\lwjgl_util.jar; src\Main.java
src\Terrain.java
\end{verbatim}
spuštění:
\begin{verbatim}
$  java -cp .;lib\jars\lwjgl.jar;lib\jars\lwjgl_util.jar; -Djava.library.path=lib/natives-windows Main
\end{verbatim}
\subsection{Použitím Ant}
Pokud je nainstalovaný Apache Ant, pak pro spuštění stačí příkaz
\begin{verbatim}
$  ant
\end{verbatim}
\subsection{V eclipse}
Získání a integrace \textbf {LWJGL} pod eclipse je popsána ve videu
\cite{installtut}, ale není třeba. Práce je odevzdána přímo jako projekt
%% TODO TODO TODO FIXME TODO TODO FIXME 
eclipse, tedy stačí vytvořit projekt Z
%% TODO TODO TODO FIXME TODO TODO FIXME 


\section{Ovládání hry}
Kamerou pohneme standardně klávesami WSAD a otočíme pohybem myši. Invertování
vertikálního pohledu provedeme pomocí klávesy U a přepnutí mezi drátěným a
plným modelem pomocí klávesy C.


\begin{thebibliography}{3}
\bibitem[1]{rocks}
{\em Bill Jacobs} \\
{\bf OpenGL tutorial}
	2007 - 2012 \\
\url{http://www.videotutorialsrock.com/}

\bibitem[2]{installtut}
{\em TheCodingUniverse} \\
{\bf \#1 LWJGL Workspace - LWJGL Tutorials} \\
	2011 \\
\url{http://youtu.be/0v56I5UWrYY}


\end{thebibliography}

\end{document}
